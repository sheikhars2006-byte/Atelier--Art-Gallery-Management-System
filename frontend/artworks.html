<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collection - Atelier</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="logo">ðŸŽ¨ Atelier</h1>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="artists.html">Artists</a></li>
                <li><a href="artworks.html" class="active">Collection</a></li>
                <li><a href="sales.html">Sales</a></li>
                <li><a href="exhibitions.html">Exhibitions</a></li>
                <li><a href="events.html">Events</a></li>
                <li><a href="billing.html">Billing</a></li>
                <li><a href="artist-submit.html">Submit Artwork</a></li>
                <li><a href="admin-submissions.html">Manage Submissions</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <header class="page-header">
            <h1>Curated Collection</h1>
            <div class="filter-buttons">
                <button class="btn" onclick="filterArtworks('all')">All Artworks</button>
                <button class="btn" onclick="filterArtworks('available')">Available</button>
                <button class="btn" onclick="filterArtworks('sold')">Sold</button>
            </div>
        </header>

        <div class="artworks-grid" id="artworksGrid">
            <p style="text-align: center; grid-column: 1/-1;">Loading artworks...</p>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Atelier Contemporary Art Gallery</p>
    </footer>

    <script src="auth.js"></script>
    <script>
        let allArtworks = [];

        // Predefined images for original artworks (IDs 1-12)
        const originalArtworkImages = {
            1: 'https://images.pexels.com/photos/1103970/pexels-photo-1103970.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            2: 'https://images.pexels.com/photos/1988681/pexels-photo-1988681.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            3: 'https://images.pexels.com/photos/417173/pexels-photo-417173.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            4: 'https://images.pexels.com/photos/1194420/pexels-photo-1194420.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            5: 'https://images.pexels.com/photos/936722/pexels-photo-936722.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            6: 'https://images.pexels.com/photos/1108099/pexels-photo-1108099.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            7: 'https://images.pexels.com/photos/2131967/pexels-photo-2131967.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            8: 'https://images.pexels.com/photos/1569076/pexels-photo-1569076.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            9: 'https://images.pexels.com/photos/1109354/pexels-photo-1109354.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            10: 'https://images.pexels.com/photos/414612/pexels-photo-414612.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            11: 'https://images.pexels.com/photos/56866/garden-rose-red-pink-56866.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            12: 'https://images.pexels.com/photos/1154510/pexels-photo-1154510.jpeg?auto=compress&cs=tinysrgb&w=400&h=300'
        };

        // Category-based images for NEW approved artworks
        const categoryImages = {
            'Painting': 'https://images.pexels.com/photos/1145720/pexels-photo-1145720.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            'Abstract': 'https://images.pexels.com/photos/1103970/pexels-photo-1103970.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            'Landscape': 'https://images.pexels.com/photos/417173/pexels-photo-417173.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            'Portrait': 'https://images.pexels.com/photos/1108099/pexels-photo-1108099.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            'Seascape': 'https://images.pexels.com/photos/414612/pexels-photo-414612.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            'Watercolor': 'https://images.pexels.com/photos/1264210/pexels-photo-1264210.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            'Digital Art': 'https://images.pexels.com/photos/936722/pexels-photo-936722.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            'Sculpture': 'https://images.pexels.com/photos/1569076/pexels-photo-1569076.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            'Photography': 'https://images.pexels.com/photos/1266808/pexels-photo-1266808.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            'Surrealism': 'https://images.pexels.com/photos/1988681/pexels-photo-1988681.jpeg?auto=compress&cs=tinysrgb&w=400&h=300',
            'Mixed Media': 'https://images.pexels.com/photos/1579708/pexels-photo-1579708.jpeg?auto=compress&cs=tinysrgb&w=400&h=300'
        };

        window.addEventListener('DOMContentLoaded', () => loadArtworks('all'));

        async function loadArtworks(filter = 'all') {
            try {
                let url = 'http://localhost:3000/api/artworks';
                if (filter === 'available') {
                    url = 'http://localhost:3000/api/artworks/available';
                }
                
                const response = await fetch(url);
                allArtworks = await response.json();
                
                if (filter === 'sold') {
                    allArtworks = allArtworks.filter(art => art.Status === 'Sold');
                }
                
                displayArtworks(allArtworks);
            } catch (error) {
                console.error('Error loading artworks:', error);
                document.getElementById('artworksGrid').innerHTML = 
                    '<p style="color: red; grid-column: 1/-1; text-align: center;">Error loading artworks</p>';
            }
        }

        function getArtworkImage(artwork) {
            // Priority 1: Use Image_URL from database if it exists and is not empty
            if (artwork.Image_URL && artwork.Image_URL.trim() !== '') {
                return artwork.Image_URL;
            }
            
            // Priority 2: Use predefined image for original artworks (IDs 1-12)
            if (originalArtworkImages[artwork.Artwork_ID]) {
                return originalArtworkImages[artwork.Artwork_ID];
            }
            
            // Priority 3: Use category-based image for new artworks
            if (artwork.Category && categoryImages[artwork.Category]) {
                return categoryImages[artwork.Category];
            }
            
            // Fallback: Generic art image
            return 'https://images.pexels.com/photos/1568607/pexels-photo-1568607.jpeg?auto=compress&cs=tinysrgb&w=400&h=300';
        }

        function displayArtworks(artworks) {
            const grid = document.getElementById('artworksGrid');
            
            if (artworks.length === 0) {
                grid.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">No artworks found</p>';
                return;
            }
            
            grid.innerHTML = artworks.map(artwork => `
                <div class="artwork-card">
                    <div class="artwork-image">
                        <img src="${getArtworkImage(artwork)}" 
                             alt="${artwork.Title}"
                             loading="lazy"
                             onerror="this.src='https://images.pexels.com/photos/1568607/pexels-photo-1568607.jpeg?auto=compress&cs=tinysrgb&w=400&h=300'">
                        <span class="status-badge ${artwork.Status === 'Available' ? 'status-available' : 'status-sold'}">
                            ${artwork.Status}
                        </span>
                    </div>
                    <div class="artwork-details">
                        <h3>${artwork.Title}</h3>
                        <p><strong>Artist:</strong> ${artwork.Artist_Name || 'Unknown'}</p>
                        <p><strong>Category:</strong> ${artwork.Category}</p>
                        <p><strong>Year:</strong> ${artwork.Year_Created}</p>
                        <p><strong>Price:</strong> â‚¹${artwork.Price.toLocaleString()}</p>
                        <p class="artwork-description">${artwork.Description || 'No description'}</p>
                    </div>
                </div>
            `).join('');
        }

        function filterArtworks(filter) {
            loadArtworks(filter);
        }
    </script>
</body>
</html>